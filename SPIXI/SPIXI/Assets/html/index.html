<!DOCTYPE html>
<html>
<!-- saved from url=(0016)http://localhost -->
<head lang="en">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, shrink-to-fit=no, user-scalable=no">

    <title>Spixi</title>
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/spixiui.css">

    <link rel="stylesheet" type="text/css" href="libs/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" type="text/css" href="libs/fontawesome/css/solid.min.css">


    <script src="js/jquery.min.js"></script>

    <script src="js/jquery.touchSwipe.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/qrcode.min.js"></script>
    <script src="js/spixi.js"></script>
    <script src="js/jquery.touchSwipe.min.js"></script>

</head>
<body onload="ixian:onload();">
    <div id="wrap" class="container-fluid noselect">

        <!-- Toolbar Main-->
        <div class="spixi-toolbar shadow">
            <div class="spixi-toolbar-line"></div>
            <div class="row spixi-toolbar-row">
                <div class="col-2" id="MainMenu">
                    <i class="fas fa-bars"></i>
                </div>
                <div class="col-8" style="padding-right: 50pt;">
                    <div class="spixi-toolbar-logo" onclick="countLogoClick();"></div>
                </div>
                <div class="col-2">
                </div>
            </div>

        </div>
        <div class="spixi-toolbar-holder"></div>
        <!-- End Toolbar -->

        <!-- ErrorBar -->
        <div id="warning_bar" class="spixi-errorbar" style="display:none">
            <div class="spixi-errorbar-icon"><i class="fa fa-info-circle"></i></div>
            <div class="spixi-errorbar-message"></div>
        </div>
        <!-- End ErrorBar-->

        <div id="tabholder" class="tab-content">
            <!-- HOME -->
            <div id="home" class="tab-pane in active">
                <!-- BalanceBar -->
                <div id="status_balance" class="spixi-balancebar">
                    <div class="spixi-balancebar-label">*SL{index-balance}</div>
                    <div class="spixi-balancebar-balance" id="activity_balance_number"></div>
                    <div class="spixi-balancebar-line"></div>
                    <div class="spixi-balancebar-info" id="activity_balance_info">*SL{index-balance-info}</div>

                    <a href="ixian:quickscan">
                        <div class="spixi-balancebar-quickscan">
                            <div class="spixi-button smallround">
                                <i class="fas fa-qrcode"></i>
                            </div>
                        </div>
                    </a>
                </div>
                <!-- End BalanceBar -->


                <div id="exp1" class="spixi-expansion">
                    <div id="exp1-left" class="spixi-expansion-left active"></div>
                    <div class="spixi-expansion-icon"><i class="fa fa-flag"></i></div>
                    <div class="spixi-expansion-text">*SL{index-notifications} (<span id="notification_count">0</span>)</div>
                    <div class="spixi-expansion-right"><i id="exp1-icon" class="fa fa-minus"></i></div>
                </div>
                <div id="exp1-contents" class="spixi-expansion-middle" style="display: block;">

                </div>
                <div class="spixi-expansion-bottom"></div>


                <div id="exp2" class="spixi-expansion">
                    <div id="exp2-left" class="spixi-expansion-left active"></div>
                    <div class="spixi-expansion-icon"><i class="fa fa-comment"></i></div>
                    <div class="spixi-expansion-text">*SL{index-unread-chats} (<span id="unread_count">0</span>)</div>
                    <div class="spixi-expansion-right"><i id="exp2-icon" class="fa fa-minus"></i></div>
                </div>
                <div id="exp2-contents" class="spixi-expansion-middle" style="display: block;">

                </div>
                <div class="spixi-expansion-bottom"></div>


                <a href="javascript:onHomeMenuAction();" class="action-button">
                    <div class="spixi-button center round">
                        <i class="fas fa-plus"></i>
                    </div>
                </a>
            </div>

            <!-- CHATS -->
            <div id="chats" class="tab-pane">
                <div id="chat_no_activity" class="container">
                    <div class="spixi-list-placeholer-text">
                        *SL{index-no-conversations}
                    </div>
                </div>

                <div id="chatlist" style="display: block;">
                </div>

                <a href="ixian:newchat" class="action-button">
                    <div class="spixi-button center round">
                        <i class="fas fa-comment-dots"></i>
                    </div>
                </a>
            </div>

            <!-- WALLET -->
            <div id="wallet" class="tab-pane ">
                <!-- BalanceBar -->
                <div id="wallet_balance" class="spixi-balancebar">
                    <div class="spixi-balancebar-label">*SL{index-balance}</div>
                    <div class="spixi-balancebar-balance" id="wallet_balance_number"></div>
                    <div class="spixi-balancebar-line"></div>
                    <div class="spixi-balancebar-info" id="wallet_balance_info">*SL{index-balance-info}</div>

                    <a href="ixian:quickscan">
                        <div class="spixi-balancebar-quickscan">
                            <div class="spixi-button smallround">
                                <i class="fas fa-qrcode"></i>
                            </div>
                        </div>
                    </a>
                </div>
                <!-- End BalanceBar -->
                <!-- OptionBar -->
                <div class="spixi-optionbar">
                    <div class="spixi-optionbar-frame container">
                        <div class="row" id="">
                            <div class="col-4 spixi-optionbar-tab">
                                <a href="ixian:sendixi">
                                    <div class="spixi-optionbar-tab-icon"><i class="fa fa-angle-double-up"></i></div>
                                    <div class="spixi-optionbar-label">*SL{index-send}</div>
                                </a>
                            </div>

                            <div class="col-4 spixi-optionbar-tab">
                                <a href="ixian:activity">
                                    <div class="spixi-optionbar-tab-icon"><i class="fa fa-chart-line"></i></div>
                                    <div class="spixi-optionbar-label">*SL{index-activity}</div>
                                </a>
                            </div>

                            <div class="col-4 spixi-optionbar-tab">
                                <a href="ixian:receiveixi">
                                    <div class="spixi-optionbar-tab-icon"><i class="fa fa-angle-double-down"></i></div>
                                    <div class="spixi-optionbar-label">*SL{index-receive}</div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End OptionBar -->

                <div id="exp3" class="spixi-expansion">
                    <div id="exp3-left" class="spixi-expansion-left active"></div>
                    <div class="spixi-expansion-icon"><i class="fa fa-history"></i></div>
                    <div class="spixi-expansion-text">*SL{index-recent-activity}</div>
                    <div class="spixi-expansion-right"><i id="exp3-icon" class="fa fa-minus"></i></div>
                </div>
                <div id="exp3-contents" class="spixi-expansion-middle" style="display: block;">
                    <div id="paymentlist">

                    </div>
                </div>
                <div class="spixi-expansion-bottom"></div>
            </div>


            <!-- CONTACTS -->
            <div id="contacts" class="tab-pane ">
                <div class="spixi-textfield-holder">
                    <input type="text" class="spixi-textfield" id="contactInput" onkeyup="contactSearch()" placeholder="*SL{index-contacts-placeholder}">
                    <span class="fa fa-search spixi-textfield-holder-icon"></span>
                </div>
                <hr class="spixi-separator-full" />

                <div id="contactslist">

                </div>

                <a href="ixian:newcontact" class="action-button">
                    <div class="spixi-button center round">
                        <i class="fas fa-user-plus"></i>
                    </div>
                </a>

            </div>
        </div>


        <div class="spixi-holder-64"></div>

    </div>  <!-- Wrap -->
    <!-- Tabbar -->
    <div id="footer" class="fixed-bottom spixi-footer">
        <div class="" style="width:90%; margin: auto;">
            <ul class="nav nav-tabs row no-gutters spixi-footer-row">
                <li id="tab1" class="col-3 spixi-tab active">
                    <a data-toggle="tab" href="#home" class="spixi-tab-pad">
                        <div class="spixi-tab-icon"><i class="fa fa-home"></i></div>
                        *SL{index-tab-home}
                        <div class="tab_placeholder"></div>
                    </a>
                </li>
                <li id="tab2" class="col-3 spixi-tab">
                    <a data-toggle="tab" href="#chats" class="spixi-tab-pad">
                        <div class="spixi-tab-icon"><i class="fa fa-comment"></i><div class="spixi-footer-chat-unread-indicator"></div></div>
                        *SL{index-tab-chats}
                        <div class="tab_placeholder"></div>
                    </a>
                </li>
                <li id="tab3" class="col-3 spixi-tab">
                    <a data-toggle="tab" href="#wallet" class="spixi-tab-pad">
                        <div class="spixi-tab-icon"><i class="fa fa-wallet"></i></div>
                        *SL{index-tab-wallet}
                        <div class="tab_placeholder"></div>
                    </a>
                </li>
                <li id="tab4" class="col-3 spixi-tab">
                    <a data-toggle="tab" href="#contacts" class="spixi-tab-pad">
                        <div class="spixi-tab-icon"><i class="fa fa-address-book"></i></div>
                        *SL{index-tab-contacts}
                        <div class="tab_placeholder"></div>
                    </a>
                </li>
            </ul>
        </div>
    </div>


    <!-- Modal menu -->
    <div id="homeMenuModal" class="spixi-modal">
        <!-- Modal content -->
        <div class="modal-content">
            <div class="spixi-modal-header">
                *SL{index-new-title}
            </div>
            <hr class="spixi-separator noheightmargins" />
            <a href="javascript:selectFABOption('newcontact');"><div class="spixi-modal-item">*SL{index-new-contact}</div></a>
            <a href="javascript:selectFABOption('newchat');"><div class="spixi-modal-item">*SL{index-new-chat}</div></a>
            <a href="javascript:selectFABOption('sendixi');"><div class="spixi-modal-item">*SL{index-new-send}</div></a>
            <a href="javascript:selectFABOption('receiveixi');"><div class="spixi-modal-item">*SL{index-new-request}</div></a>
            <hr class="spixi-separator noheightmargins fullwidth" />
            <div class="spixi-modal-footer">
                <a href="javascript:onHomeMenuClose();">
                    <div class="spixi-modal-close">*SL{index-new-cancel}</div>
                </a>
            </div>

        </div>
    </div>


    <!-- Left sidebar and helper -->
    <div id="leftSidebarHelper" class="spixi-leftswipe-helper">
    </div>

    <div id="leftSidebar" class="spixi-sidebar">
        <!-- Modal content -->
        <div class="spixi-sidebar-content">
            <div class="spixi-sidebar-header">
                <a id="sidebarclose" class="spixi-sidebar-closebutton" href="javascript: onMainMenuClose();">
                    <i class="fa fa-arrow-left"></i>
                </a>

                <div id="avatar" class="spixi-sidebar-avatar-holder">
                    <img id="avatar_image" class="spixi-sidebar-avatar" src="img/spixiavatar.png" />
                </div>
                <p id="menu_nickname" class="spixi-sidebar-title">*SL{index-side-title}</p>
            </div>


            <div class="spixi-sidebar-item">
                <a href="javascript:selectMenuOption('address');">
                    <i class="fa fa-wallet spixi-sidebar-item-icon"></i>
                    <div class="spixi-sidebar-item-text">*SL{index-side-myaddress}</div>
                </a>
            </div>

            <!--<div class="spixi-sidebar-item">
        <a href="javascript:selectMenuOption('apps');">
            <i class="fa fa-code spixi-sidebar-item-icon"></i>
            <div class="spixi-sidebar-item-text">*SL{index-side-apps}</div>
        </a>
    </div>-->

            <div class="spixi-sidebar-item">
                <a href="javascript:selectMenuOption('downloads');">
                    <i class="fa fa-download spixi-sidebar-item-icon"></i>
                    <div class="spixi-sidebar-item-text">*SL{index-side-downloads}</div>
                </a>
            </div>

            <div class="spixi-sidebar-item">
                <a href="javascript:selectMenuOption('settings');">
                    <i class="fa fa-cog spixi-sidebar-item-icon"></i>
                    <div class="spixi-sidebar-item-text">*SL{index-side-settings}</div>
                </a>
            </div>
            <!-- Security Lock is not available in this version
    <div class="spixi-sidebar-item">
        <a href="javascript:selectMenuOption('lock');">
            <i class="fa fa-lock spixi-sidebar-item-icon"></i>
            <div class="spixi-sidebar-item-text">*SL{index-side-security}</div>
        </a>
    </div>
    -->
            <div class="spixi-sidebar-item">
                <a href="javascript:selectMenuOption('backup');">
                    <i class="fa fa-save spixi-sidebar-item-icon"></i>
                    <div class="spixi-sidebar-item-text">*SL{index-side-backup}</div>
                </a>
            </div>

            <div class="spixi-sidebar-item">
                <a href="javascript:selectMenuOption('encpass');">
                    <i class="fa fa-fingerprint spixi-sidebar-item-icon"></i>
                    <div class="spixi-sidebar-item-text">*SL{index-side-password}</div>
                </a>
            </div>

            <div class="spixi-sidebar-item">
                <a href="javascript:selectMenuOption('guide');">
                    <i class="fa fa-lightbulb spixi-sidebar-item-icon"></i>
                    <div class="spixi-sidebar-item-text">*SL{index-side-howtouse}</div>
                </a>
            </div>

            <div class="spixi-sidebar-item" id="SendLogMenuItem" style="display: none;">
                <a href="javascript:selectMenuOption('viewLog');">
                    <i class="fa fa-clipboard-check spixi-sidebar-item-icon"></i>
                    <div class="spixi-sidebar-item-text">*SL{index-side-sendlog}</div>
                </a>
            </div>

            <div class="spixi-sidebar-item">
                <a href="javascript:selectMenuOption('about');">
                    <i class="fa fa-info spixi-sidebar-item-icon"></i>
                    <div class="spixi-sidebar-item-text">*SL{index-side-about}</div>
                </a>
            </div>

            <div class="spixi-version" id="version">
            </div>
        </div>
    </div>
    <!-- End left sidebar and helper -->


    <script type="text/javascript">

    var searchingContacts = false;
    var timeoutId = 0;
    var balance = "0";

    var homeModal = document.getElementById('homeMenuModal');

    function htmlEscape(str) {
        return str
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\//g, '&#x2F;');
    }

    function onMainMenuAction() {
        leftSidebar.style.display = "block";
    }

    function onMainMenuClose() {
        leftSidebar.style.display = "none";
    }

    function onHomeMenuAction()
    {
        homeModal.style.display = "block";
    }

    function onHomeMenuClose()
    {
        homeModal.style.display = "none";
    }

    // Handle modals outside tap
    window.onclick = function(event) {
        if (event.target == homeModal) {
            onHomeMenuClose();
        }
        else if (event.target == leftSidebar) {
            leftSidebar.style.display = "none";
        }
    }

    function setVersion(version) {
        document.getElementById("version").innerHTML = version;
    }

    $('#status_balance').on('mousedown touchstart', function() {
        timeoutId = setTimeout(toggleBalance, 1000);
    }).on('mouseup mouseleave touchend', function() {
        clearTimeout(timeoutId);
    });

    $('#wallet_balance').on('mousedown touchstart', function() {
        timeoutId = setTimeout(toggleBalance, 1000);
    }).on('mouseup mouseleave touchend', function() {
        clearTimeout(timeoutId);
    });


    // Toolbar
    document.getElementById("MainMenu").onclick = function() {
        onMainMenuAction();
    }

    document.getElementById("exp1").onclick = function() {
        var x = document.getElementById("exp1-contents");
        var eleft = document.getElementById("exp1-left");
        var eicon = document.getElementById("exp1-icon");



        if (x.style.display === "none")
        {
            x.style.display = "block";
            eleft.className = "spixi-expansion-left active";
            eicon.className = "fa fa-minus";
        }
        else
        {
            x.style.display = "none";
            eleft.className = "spixi-expansion-left";
            eicon.className = "fa fa-caret-down";

        }

    }

    document.getElementById("exp2").onclick = function() {
        var x = document.getElementById("exp2-contents");
        var eleft = document.getElementById("exp2-left");
        var eicon = document.getElementById("exp2-icon");



        if (x.style.display === "none")
        {
            x.style.display = "block";
            eleft.className = "spixi-expansion-left active";
            eicon.className = "fa fa-minus";
        }
        else
        {
            x.style.display = "none";
            eleft.className = "spixi-expansion-left";
            eicon.className = "fa fa-caret-down";

        }

    }

    document.getElementById("exp3").onclick = function() {
        var x = document.getElementById("exp3-contents");
        var eleft = document.getElementById("exp3-left");
        var eicon = document.getElementById("exp3-icon");



        if (x.style.display === "none")
        {
            x.style.display = "block";
            eleft.className = "spixi-expansion-left active";
            eicon.className = "fa fa-minus";
        }
        else
        {
            x.style.display = "none";
            eleft.className = "spixi-expansion-left";
            eicon.className = "fa fa-caret-down";

        }

    }


    function setBalance(theText, theNick) {
        var balDiv = document.getElementById('activity_balance_number');
        var balDiv2 = document.getElementById('wallet_balance_number');

        balance = theText;

        if(balDiv.innerHTML != "&nbsp;")
            balDiv.innerHTML = balance;

        if(balDiv2.innerHTML != "&nbsp;")
            balDiv2.innerHTML = balance;

        // Set the user nickname
        document.getElementById('menu_nickname').innerHTML = theNick;
    }

    function toggleBalance()
    {
        var balDiv = document.getElementById('activity_balance_number');
        if(balDiv.innerHTML == "&nbsp;")
        {
            balDiv.innerHTML = balance;
            document.getElementById('wallet_balance_number').innerHTML = balance;
            document.getElementById('activity_balance_info').innerHTML = "*SL{index-balance-info}";
            document.getElementById('wallet_balance_info').innerHTML = "*SL{index-balance-info}";

        }
        else
        {
            balDiv.innerHTML = "&nbsp;";
            document.getElementById('wallet_balance_number').innerHTML = "&nbsp;";
            document.getElementById('activity_balance_info').innerHTML = "*SL{index-balance-info2}";
            document.getElementById('wallet_balance_info').innerHTML = "*SL{index-balance-info2}";

        }
    }

    function selectFABOption(link) {
        onHomeMenuClose();
        location.href = "ixian:" + link;
    }

    function selectMenuOption(link) {
        onMainMenuClose();
        location.href = "ixian:" + link;
    }

    function loadAvatar(avatar_path) {
        avatar_path = avatar_path.replace(/&#92;/g, '\\');

        var av_path = avatar_path + "?t=" + new Date().getTime();
        document.getElementById("avatar_image").src = av_path;
    }

    // Filter in the CONTACTS tab
    function contactSearch()
    {
        var a,b,i,row;
        var input = document.getElementById('contactInput');
        var filter = input.value.toUpperCase();
        var c_contactlist = document.getElementById("contactslist");
        var c_items = c_contactlist.getElementsByClassName('spixi-list-item');

        if (isBlank(filter) == true) {
            searchingContacts = false;
        }
        else {
            searchingContacts = true;
        }

        // Go through each element and filter out non-matching elements
        for (i = 0; i < c_items.length; i++) {
            row = c_items[i].getElementsByTagName("div")[0];
            b = row.getElementsByTagName("div")[2];
            a = b.getElementsByTagName("div")[0];

            if (a.innerHTML.toUpperCase().indexOf(filter) > -1) {
                c_items[i].style.display = "";
            } else {
                c_items[i].style.display = "none";
            }
        }
    }

    // Clears all contacts from contacts page
    function clearContacts()
    {
        if (searchingContacts == true) {
            return;
        }

        var contactsNode = document.getElementById("contactslist");
        while (contactsNode.firstChild) {
            contactsNode.removeChild(contactsNode.firstChild);
        }
    }

    // Adds a contact to the contacts page
    function addContact(wal, name, avatar, online, unread)
    {
        name = htmlEscape(name);
        avatar = avatar.replace(/&#92;/g, '\\');

        if (searchingContacts == true) {
            return;
        }

        var indicator = " offline";
        if (online == "true") {
            indicator = " online";
        }

        var unreadIndicator = "";
        if (unread > 0) {
            unreadIndicator = " unread";
        }

        var contactsNode = document.getElementById("contactslist");

        var contactEntry = document.createElement("div");
        contactEntry.className = "spixi-list-item" + indicator + unreadIndicator;
        contactEntry.innerHTML = '<a href="ixian:details:' + wal + '"><div class="row"><div class="col-2 spixi-list-item-left"><img class="spixi-list-item-avatar" src="' + avatar + '"/><div class="spixi-friend-status-indicator"></div></div><div class="col-8 spixi-list-item-center"><div class="spixi-list-item-title-center">' + name + '</div></div><div class="col-2 spixi-list-item-right"><div class="spixi-chat-unread-indicator"></div></div></div></a>';

        contactsNode.appendChild(contactEntry);
    }


    // Clears payment activity from wallet page
    function clearPaymentActivity()
    {
        var paymentsNode = document.getElementById("paymentlist");
        while (paymentsNode.firstChild) {
            paymentsNode.removeChild(paymentsNode.firstChild);
        }
    }

    // Adds a payment
    function addPaymentActivity(txid, text, timestamp, amount, confirmed)
    {
        var iconClass = "spixi-text-red";
        var icon = '<i class="fa fa-circle-notch fa-spin"></i>';
        if (confirmed == "true") {
            iconClass = "spixi-text-green";
            icon = '<i class="fa fa-check-circle"></i>';
        }else if(confirmed == "error")
        {
            iconClass = "spixi-text-red";
            icon = '<i class="fa fa-exclamation-circle"></i>';
        }

        var paymentsNode = document.getElementById("paymentlist");

        var paymentEntry = document.createElement("div");
        paymentEntry.className = "spixi-list-item payment";
        paymentEntry.innerHTML = '<a href="ixian:txdetails:' + txid + '"><div class="row"><div class="col-2 spixi-list-item-left"><div class="' + iconClass + '">' + icon + '</div></div><div class="col-6 spixi-list-item-center"><div class="spixi-list-item-title">' + text + '</div><div class="spixi-list-item-subtitle">' + amount + '</div></div><div class="col-4 spixi-list-item-right"><div class="spixi-timestamp">' + timestamp + '</div></div></div></a>';

        paymentsNode.appendChild(paymentEntry);
    }

    // Clears all chats from chats page
    function clearChats() {
        document.getElementById("chatlist").innerHTML = "";
    }

    // Adds a chat
    function addChat(wallet, from, timestamp, avatar, online, excerpt_msg, unread)
    {
        from = htmlEscape(from);
        timestamp = htmlEscape(timestamp);
        avatar = avatar.replace(/&#92;/g, '\\');
        excerpt_msg = htmlEscape(excerpt_msg);

        var excerpt = excerpt_msg;

        var indicator = " offline";
        if (online == "true") {
            indicator = " online";
        }

        var unreadIndicator = "";
        if (unread > 0) {
            unreadIndicator = " unread";
        }

        var timeClass = "spixi-timestamp";
        var relativeTime = getRelativeTime(timestamp);

        if (getTimeDifference(timestamp) < 3600) {
            timeClass = "spixi-timestamp spixi-rel-ts-active";
        }

        var chatsNode = document.getElementById("chatlist");
        var readmsg = document.createElement("a");
        readmsg.href = "ixian:chat:" + wallet;
        readmsg.innerHTML = '<div class="spixi-list-item' + indicator + unreadIndicator + '"><div class="row"><div class="col-2 spixi-list-item-left"><img class="spixi-list-item-avatar" src="' + avatar + '"/><div class="spixi-friend-status-indicator"></div></div><div class="col-6 spixi-list-item-center"><div class="spixi-list-item-title">' + from + '</div><div class="spixi-list-item-subtitle">' + excerpt + '</div></div><div class="col-4 spixi-list-item-right"><div class="spixi-chat-unread-indicator"></div><div class="' + timeClass + '" data-timestamp="' + timestamp + '">' + relativeTime + '</div></div></div></div>';

        chatsNode.appendChild(readmsg);
        document.getElementById("chatlist").style.display = 'block';
        document.getElementById("chat_no_activity").style.display = 'none';
    }

    function setUnreadIndicator(unread_count) {
        if (unread_count != "0") {
            document.getElementById("tab2").firstElementChild.className = "spixi-tab-pad unread";
        } else {
            document.getElementById("tab2").firstElementChild.className = "spixi-tab-pad";
        }
        document.getElementById("unread_count").innerHTML = unread_count;
    }

    // Clears all unread activity from main page
    function clearUnreadActivity() {
        document.getElementById("exp2-contents").innerHTML = "";
    }

    function addUnreadActivity(wallet, from, timestamp, avatar, online, excerpt_msg) {
        from = htmlEscape(from);
        timestamp = htmlEscape(timestamp);
        avatar = avatar.replace(/&#92;/g, '\\');
        excerpt_msg = htmlEscape(excerpt_msg);

        var excerpt = excerpt_msg;

        var indicator = " offline";
        if (online == "true") {
            indicator = " online";
        }

        var timeClass = "spixi-timestamp";
        var relativeTime = getRelativeTime(timestamp);

        if (getTimeDifference(timestamp) < 3600) {
            timeClass = "spixi-timestamp spixi-rel-ts-active";
        }

        var chatsNode = document.getElementById("exp2-contents");
        var readmsg = document.createElement("div");
        readmsg.href = "ixian:chat:" + wallet;
        readmsg.className = "spixi-list-item " + indicator;
        readmsg.innerHTML = '<a href="ixian:chat:' + wallet + '"><div class="row"><div class="col-2 spixi-list-item-left"><img class="spixi-list-item-avatar" src="' + avatar + '"/><div class="spixi-friend-status-indicator"></div></div><div class="col-6 spixi-list-item-center"><div class="spixi-list-item-title">' + from + '</div><div class="spixi-list-item-subtitle">' + excerpt + '</div></div><div class="col-4 spixi-list-item-right"><div class="' + timeClass + '" data-timestamp="' + timestamp + '">' + relativeTime + '</div></div></div></a>';

        chatsNode.appendChild(readmsg);
        document.getElementById("chatlist").style.display = 'block';
        document.getElementById("chat_no_activity").style.display = 'none';
    }

    function setNotificationCount(notification_count) {
        document.getElementById("notification_count").innerHTML = notification_count;
    }

    // Function to toggle tab's active color
    $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
        // Not very elegant, but it works
        document.getElementById("tab1").className = "col-3 spixi-tab";
        document.getElementById("tab2").className = "col-3 spixi-tab";
        document.getElementById("tab3").className = "col-3 spixi-tab";
        document.getElementById("tab4").className = "col-3 spixi-tab";

        var cl = "active";
        e.target.parentElement.className = "col-3 spixi-tab " + cl;

        var tabid = e.target.parentElement.id;
        location.href = "ixian:tab:" + tabid;
    });



    // Handle sidebar swiping
    $("#leftSidebarHelper").swipe( {
        swipeStatus:function(event, phase, direction, distance)
        {
            var str = "";
            if(direction == "right")
            {
                leftSidebar.style.display = "block";
                document.getElementById('leftSidebarHelper').style.display = "none";

                var transformStyle = 'translateX(0px)';
                leftSidebar.style.webkitTransform = transformStyle;
                leftSidebar.style.MozTransform = transformStyle;
                leftSidebar.style.msTransform = transformStyle;
                leftSidebar.style.transform = transformStyle;
            }
        },
        threshold:10
    });

    $("#leftSidebar").swipe( {
        swipeStatus:function(event, phase, direction, distance)
        {
            if(direction == "left")
            {
                if (phase=="move")
                {
                    var transformStyle = 'translateX(-'+distance+'px)';
                    leftSidebar.style.webkitTransform = transformStyle;
                    leftSidebar.style.MozTransform = transformStyle;
                    leftSidebar.style.msTransform = transformStyle;
                    leftSidebar.style.transform = transformStyle;
                }

                if (phase == "end" || phase == "cancel")
                {
                    if(distance > 100)
                    {
                        leftSidebar.style.display = "none";
                        document.getElementById('leftSidebarHelper').style.display = "block";
                    }
                    var transformStyle = 'translateX(0px)';
                    leftSidebar.style.webkitTransform = transformStyle;
                    leftSidebar.style.MozTransform = transformStyle;
                    leftSidebar.style.msTransform = transformStyle;
                    leftSidebar.style.transform = transformStyle;
                }
            }
        },
        triggerOnTouchEnd:true,
        threshold:100,
        allowPageScroll:"vertical"
    });



    function selectTab(tab) {
        $("#" + tab + " > a").tab('show');
    }


        var logoClicked = 0;

        function countLogoClick()
        {
            logoClicked++;
            if(logoClicked > 10)
            {
                document.getElementById("SendLogMenuItem").style.display = "block";
                alert("*SL{index-devmode}");
            }
        }
    </script>
</body>
</html>